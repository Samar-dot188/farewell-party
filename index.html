<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Farewell Tribute</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #111;
      color: #fff;
      font-family: 'Courier New', Courier, monospace;
    }

    canvas {
      display: block;
      background: linear-gradient(to top, #444, #222);
    }

    #message {
      position: absolute;
      bottom: 20px;
      width: 100%;
      text-align: center;
      font-size: 1.2em;
      color: #00ffff;
      white-space: pre-line;
      opacity: 0;
      transition: opacity 0.8s ease-in-out;
    }
  </style>
</head>
<body>
  <canvas id="bgCanvas" width="800" height="400"></canvas>
  <div id="message"></div>
  <audio id="bgm" src="farewell.mp3" loop></audio>

  <script>
    const canvas = document.getElementById('bgCanvas');
    const ctx = canvas.getContext('2d');
    const messageBox = document.getElementById('message');
    const bgm = document.getElementById('bgm');

    // Resize canvas to window size
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Floating Stars
    const stars = Array.from({ length: 100 }, () => ({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      r: Math.random() * 2 + 0.5,
      speed: Math.random() * 0.5 + 0.2
    }));

    function drawStars() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = '#fff';
      stars.forEach(star => {
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.r, 0, Math.PI * 2);
        ctx.fill();
        star.y += star.speed;
        if (star.y > canvas.height) {
          star.y = 0;
          star.x = Math.random() * canvas.width;
        }
      });
      requestAnimationFrame(drawStars);
    }
    drawStars();

    // Typewriter Message
    const messageText = [
      "Dear Teacher,",
      "You've taught us more than just ICT.",
      "You showed us how to think, explore, and be curious.",
      "We'll miss your jokes during class and your endless patience!",
      "From formatting Word docs...",
      "To understanding algorithms...",
      "You made computers FUN.",
      "Hereâ€™s a virtual standing ovation from all of us! ğŸ‘ğŸ‘ğŸ‘",
      "With love, from Grade 6 ğŸ’»ğŸ’™",
      "Goodbye and best wishes on your next adventure!",
      "Thank You!",
    ];

    let index = 0;
    let charIndex = 0;
    let currentLine = '';

    function typeWriter() {
      messageBox.style.opacity = 1;

      if (index < messageText.length) {
        const line = messageText[index];

        if (charIndex < line.length) {
          currentLine += line.charAt(charIndex);
          messageBox.textContent = messageBox.textContent.replace(/\n*$/, '') + currentLine + '\n';
          charIndex++;
          setTimeout(typeWriter, 50);
        } else {
          currentLine = '';
          charIndex = 0;
          index++;
          setTimeout(typeWriter, 800);
        }
      } else {
        messageBox.textContent += "\nğŸ’– The End ğŸ’–";
      }
    }

    // Start message and audio after 3 seconds or press 'f'
    setTimeout(() => {
      if (index === 0) {
        typeWriter();
        bgm.play().catch(() => {}); // Handle autoplay restrictions silently
      }
    }, 3000);

    window.addEventListener('keydown', (e) => {
      if (e.key === 'f' && index === 0) {
        typeWriter();
        bgm.play().catch(() => {});
      }
    });
  </script>
</body>
</html>
